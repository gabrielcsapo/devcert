"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const yargs_1 = require("yargs");
const constants_1 = require("./constants");
const express = require("express");
const fs = require("fs");
const app = express();
const port = yargs_1.argv.port;
app.get('/getRemoteCertificate', (req, res) => {
    if (fs.existsSync(constants_1.rootCACertPath)) {
        res.send(fs.readFileSync(constants_1.rootCACertPath, 'utf8'));
    }
});
const server = app.listen(port, () => console.log(`Server started at port: ${port}`));
app.get('/closeRemoteServer', (req, res) => {
    res.send('Server closing');
    server.close(() => {
        console.log('Process terminated');
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVtb3RlLmpzIiwic291cmNlUm9vdCI6Ii4vIiwic291cmNlcyI6WyJzcmMvcmVtb3RlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsaUNBQTZCO0FBQzdCLDJDQUE2QztBQUM3QyxtQ0FBb0M7QUFDcEMseUJBQXlCO0FBRXpCLE1BQU0sR0FBRyxHQUFHLE9BQU8sRUFBRSxDQUFDO0FBQ3RCLE1BQU0sSUFBSSxHQUFHLFlBQUksQ0FBQyxJQUFJLENBQUM7QUFFdkIsR0FBRyxDQUFDLEdBQUcsQ0FBQyx1QkFBdUIsRUFBRSxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsRUFBRTtJQUM1QyxJQUFJLEVBQUUsQ0FBQyxVQUFVLENBQUMsMEJBQWMsQ0FBQyxFQUFFO1FBQ2pDLEdBQUcsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLFlBQVksQ0FBQywwQkFBYyxFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUM7S0FDbkQ7QUFDSCxDQUFDLENBQUMsQ0FBQztBQUVILE1BQU0sTUFBTSxHQUFHLEdBQUcsQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFLEdBQUcsRUFBRSxDQUNuQyxPQUFPLENBQUMsR0FBRyxDQUFDLDJCQUEyQixJQUFJLEVBQUUsQ0FBQyxDQUMvQyxDQUFDO0FBRUYsR0FBRyxDQUFDLEdBQUcsQ0FBQyxvQkFBb0IsRUFBRSxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsRUFBRTtJQUN6QyxHQUFHLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLENBQUM7SUFDM0IsTUFBTSxDQUFDLEtBQUssQ0FBQyxHQUFHLEVBQUU7UUFDaEIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO0lBQ3BDLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBhcmd2IH0gZnJvbSAneWFyZ3MnO1xuaW1wb3J0IHsgcm9vdENBQ2VydFBhdGggfSBmcm9tICcuL2NvbnN0YW50cyc7XG5pbXBvcnQgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTtcbmltcG9ydCAqIGFzIGZzIGZyb20gJ2ZzJztcblxuY29uc3QgYXBwID0gZXhwcmVzcygpO1xuY29uc3QgcG9ydCA9IGFyZ3YucG9ydDtcblxuYXBwLmdldCgnL2dldFJlbW90ZUNlcnRpZmljYXRlJywgKHJlcSwgcmVzKSA9PiB7XG4gIGlmIChmcy5leGlzdHNTeW5jKHJvb3RDQUNlcnRQYXRoKSkge1xuICAgIHJlcy5zZW5kKGZzLnJlYWRGaWxlU3luYyhyb290Q0FDZXJ0UGF0aCwgJ3V0ZjgnKSk7XG4gIH1cbn0pO1xuXG5jb25zdCBzZXJ2ZXIgPSBhcHAubGlzdGVuKHBvcnQsICgpID0+XG4gIGNvbnNvbGUubG9nKGBTZXJ2ZXIgc3RhcnRlZCBhdCBwb3J0OiAke3BvcnR9YClcbik7XG5cbmFwcC5nZXQoJy9jbG9zZVJlbW90ZVNlcnZlcicsIChyZXEsIHJlcykgPT4ge1xuICByZXMuc2VuZCgnU2VydmVyIGNsb3NpbmcnKTtcbiAgc2VydmVyLmNsb3NlKCgpID0+IHtcbiAgICBjb25zb2xlLmxvZygnUHJvY2VzcyB0ZXJtaW5hdGVkJyk7XG4gIH0pO1xufSk7XG4iXX0=