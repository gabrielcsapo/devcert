"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const yargs_1 = require("yargs");
const constants_1 = require("./constants");
const express = require("express");
const fs = require("fs");
const app = express();
const port = yargs_1.argv.port;
app.get('/get_remote_certificate', (req, res) => {
    if (fs.existsSync(constants_1.rootCACertPath)) {
        res.send(fs.readFileSync(constants_1.rootCACertPath, 'utf8'));
    }
});
const server = app.listen(port, () => console.log(`Server started at port: ${port}`));
app.get('/close_remote_server', (req, res) => {
    res.send('Server closing');
    server.close(() => {
        console.log('Process terminated');
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVtb3RlLmpzIiwic291cmNlUm9vdCI6Ii4vIiwic291cmNlcyI6WyJzcmMvcmVtb3RlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsaUNBQTZCO0FBQzdCLDJDQUE2QztBQUM3QyxtQ0FBbUM7QUFDbkMseUJBQXlCO0FBRXpCLE1BQU0sR0FBRyxHQUFHLE9BQU8sRUFBRSxDQUFDO0FBQ3RCLE1BQU0sSUFBSSxHQUFHLFlBQUksQ0FBQyxJQUFJLENBQUM7QUFFdkIsR0FBRyxDQUFDLEdBQUcsQ0FBQyx5QkFBeUIsRUFBRSxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsRUFBRTtJQUM5QyxJQUFJLEVBQUUsQ0FBQyxVQUFVLENBQUMsMEJBQWMsQ0FBQyxFQUFFO1FBQ2pDLEdBQUcsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLFlBQVksQ0FBQywwQkFBYyxFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUM7S0FDbkQ7QUFDSCxDQUFDLENBQUMsQ0FBQztBQUVILE1BQU0sTUFBTSxHQUFHLEdBQUcsQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFLEdBQUcsRUFBRSxDQUNuQyxPQUFPLENBQUMsR0FBRyxDQUFDLDJCQUEyQixJQUFJLEVBQUUsQ0FBQyxDQUMvQyxDQUFDO0FBRUYsR0FBRyxDQUFDLEdBQUcsQ0FBQyxzQkFBc0IsRUFBRSxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsRUFBRTtJQUMzQyxHQUFHLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLENBQUM7SUFDM0IsTUFBTSxDQUFDLEtBQUssQ0FBQyxHQUFHLEVBQUU7UUFDaEIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO0lBQ3BDLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBhcmd2IH0gZnJvbSAneWFyZ3MnO1xuaW1wb3J0IHsgcm9vdENBQ2VydFBhdGggfSBmcm9tICcuL2NvbnN0YW50cyc7XG5pbXBvcnQgKiBhcyBleHByZXNzIGZyb20gJ2V4cHJlc3MnO1xuaW1wb3J0ICogYXMgZnMgZnJvbSAnZnMnO1xuXG5jb25zdCBhcHAgPSBleHByZXNzKCk7XG5jb25zdCBwb3J0ID0gYXJndi5wb3J0O1xuXG5hcHAuZ2V0KCcvZ2V0X3JlbW90ZV9jZXJ0aWZpY2F0ZScsIChyZXEsIHJlcykgPT4ge1xuICBpZiAoZnMuZXhpc3RzU3luYyhyb290Q0FDZXJ0UGF0aCkpIHtcbiAgICByZXMuc2VuZChmcy5yZWFkRmlsZVN5bmMocm9vdENBQ2VydFBhdGgsICd1dGY4JykpO1xuICB9XG59KTtcblxuY29uc3Qgc2VydmVyID0gYXBwLmxpc3Rlbihwb3J0LCAoKSA9PlxuICBjb25zb2xlLmxvZyhgU2VydmVyIHN0YXJ0ZWQgYXQgcG9ydDogJHtwb3J0fWApXG4pO1xuXG5hcHAuZ2V0KCcvY2xvc2VfcmVtb3RlX3NlcnZlcicsIChyZXEsIHJlcykgPT4ge1xuICByZXMuc2VuZCgnU2VydmVyIGNsb3NpbmcnKTtcbiAgc2VydmVyLmNsb3NlKCgpID0+IHtcbiAgICBjb25zb2xlLmxvZygnUHJvY2VzcyB0ZXJtaW5hdGVkJyk7XG4gIH0pO1xufSk7XG4iXX0=